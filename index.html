<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kalorieberegner</title>

  <style>
    :root{
      /* Mørkeblå brand */
      --brand:#0b2a5b;       /* primær mørkeblå */
      --brand2:#163c7a;      /* hover/secondary */
      --bg:#f3f6fb;          /* lys baggrund */
      --card:#ffffff;
      --text:#0b1220;
      --muted:#5b6b84;
      --border:#dbe4f2;
      --shadow: 0 12px 34px rgba(11,18,32,.10);
      --radius:18px;
    }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
    }
    .wrap{
      max-width: 540px;
      margin: 0 auto;
      padding: 18px 16px 44px;
    }
    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    .brandMark{
      font-weight: 1000;
      letter-spacing:-.02em;
      color: var(--brand);
      display:flex;
      align-items:center;
      gap:10px;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: var(--brand);
      box-shadow: 0 6px 16px rgba(11,42,91,.25);
    }
    .pill{
      border:1px solid var(--border);
      background: #eaf1ff;
      color: var(--brand);
      border-radius:999px;
      padding:10px 14px;
      font-weight:800;
      font-size: 13px;
    }
    .card{
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }
    h1{
      margin: 6px 0 4px;
      font-size: 30px;
      letter-spacing:-.03em;
      line-height: 1.05;
    }
    .sub{
      margin:0 0 16px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.35;
    }
    .step{ display:none; }
    .step.active{ display:block; }

    .grid{ display:grid; gap:12px; }

    .sectionTitle{
      font-weight: 1000;
      margin-bottom: 2px;
      letter-spacing:-.01em;
    }

    .choice{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border:2px solid var(--border);
      border-radius: 16px;
      padding: 14px;
      cursor:pointer;
      user-select:none;
      background:#fff;
      transition: transform .08s ease, border-color .08s ease, background .08s ease;
    }
    .choice:active{ transform: scale(.995); }
    .choice .title{ font-weight: 1000; }
    .choice .desc{ color: var(--muted); font-size: 13px; margin-top: 3px; }
    .choice .chev{ color: var(--muted); font-weight: 900; }
    .choice.selected{
      border-color: var(--brand);
      background: #eef4ff;
    }

    .two{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }

    .sliderRow{
      border:1px solid var(--border);
      border-radius: 16px;
      padding: 12px;
      background:#fff;
    }
    .sliderTop{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 8px;
    }
    .label{ font-weight: 1000; }
    .val{
      color: var(--brand);
      font-weight: 1100;
      font-size: 18px;
      white-space:nowrap;
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--brand);
    }

    .btnRow{
      display:flex;
      gap:10px;
      margin-top: 14px;
    }
    button{
      width:100%;
      border:0;
      border-radius: 16px;
      padding: 14px 16px;
      font-weight: 1100;
      font-size: 16px;
      cursor:pointer;
      letter-spacing:-.01em;
    }
    .primary{
      background: var(--brand);
      color:#fff;
    }
    .primary:hover{ background: var(--brand2); }
    .ghost{
      background: #eaf1ff;
      color: var(--brand);
    }

    .resultsBar{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin: 10px 0 14px;
    }
    .resultBox{
      border-radius: 16px;
      padding: 14px;
      background: #eef4ff;
      border:1px solid #d5e3ff;
    }
    .resultBox .k{
      color: var(--muted);
      font-size: 13px;
      font-weight: 900;
      margin-bottom: 6px;
    }
    .resultBox .v{
      font-size: 28px;
      font-weight: 1200;
      color: var(--brand);
      letter-spacing: -.02em;
    }

    .note{
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
    }
    .note strong{ color: var(--text); }

    .mc{
      margin-top: 14px;
      border-top: 1px solid var(--border);
      padding-top: 14px;
    }
    .mc input[type="text"], .mc input[type="email"]{
      width:100%;
      box-sizing:border-box;
      border:1px solid var(--border);
      border-radius: 14px;
      padding: 12px 12px;
      font-size: 15px;
      margin-bottom: 10px;
      outline: none;
    }
    .mc input[type="text"]:focus, .mc input[type="email"]:focus{
      border-color: #a9c1ff;
      box-shadow: 0 0 0 3px rgba(22,60,122,.10);
    }
    .mc .consent{
      display:flex;
      gap:10px;
      align-items:flex-start;
      font-size: 13px;
      color: var(--muted);
      margin: 8px 0 14px;
    }
    .tiny{
      font-size: 12px;
      color: var(--muted);
      margin-top: 10px;
    }
    .smallLink{
      color: var(--brand);
      text-decoration: none;
      font-weight: 900;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div class="brandMark">
        <span class="dot"></span>
        <span>Kalorieberegner</span>
      </div>
      <div class="pill">Gratis beregning</div>
    </div>

    <div class="card">
      <h1>Beregn dit kaloriebehov</h1>
      <p class="sub">
        Svar på 3 korte trin. Til sidst får du din anbefaling og næste skridt sendt på mail.
      </p>

      <!-- STEP 1: Mål -->
      <section class="step active" data-step="1">
        <div class="grid">
          <div class="sectionTitle">Hvad er dit mål?</div>

          <div class="choice selected" data-goal="maintain">
            <div>
              <div class="title">Vedligehold & performance</div>
              <div class="desc">Hold vægten og få stabil energi</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="choice" data-goal="gain">
            <div>
              <div class="title">Byg muskelmasse</div>
              <div class="desc">Små overskud og progressiv træning</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="choice" data-goal="lose">
            <div>
              <div class="title">Smid fedt</div>
              <div class="desc">Kalorieunderskud uden at crashe energien</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="btnRow">
            <button class="primary" id="to2" type="button">Næste</button>
          </div>
        </div>
      </section>

      <!-- STEP 2: Basisdata -->
      <section class="step" data-step="2">
        <div class="grid">
          <div class="sectionTitle">Fortæl lidt om dig</div>

          <div class="two">
            <div class="choice selected" data-sex="female">
              <div>
                <div class="title">Kvinde</div>
                <div class="desc">Køn</div>
              </div>
            </div>
            <div class="choice" data-sex="male">
              <div>
                <div class="title">Mand</div>
                <div class="desc">Køn</div>
              </div>
            </div>
          </div>

          <div class="sliderRow">
            <div class="sliderTop">
              <div class="label">Alder</div>
              <div class="val"><span id="ageOut">35</span> år</div>
            </div>
            <input id="age" type="range" min="16" max="80" value="35" />
          </div>

          <div class="sliderRow">
            <div class="sliderTop">
              <div class="label">Højde</div>
              <div class="val"><span id="heightOut">170</span> cm</div>
            </div>
            <input id="height" type="range" min="140" max="210" value="170" />
          </div>

          <div class="sliderRow">
            <div class="sliderTop">
              <div class="label">Vægt</div>
              <div class="val"><span id="weightOut">100</span> kg</div>
            </div>
            <input id="weight" type="range" min="40" max="200" value="100" />
          </div>

          <div class="btnRow">
            <button class="ghost" data-back type="button">Tilbage</button>
            <button class="primary" id="to3" type="button">Næste</button>
          </div>
        </div>
      </section>

      <!-- STEP 3: Aktivitet -->
      <section class="step" data-step="3">
        <div class="grid">
          <div class="sectionTitle">Hvor aktiv er du?</div>

          <div class="choice selected" data-activity="1.375">
            <div>
              <div class="title">Let aktiv</div>
              <div class="desc">1–3 træninger om ugen</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="choice" data-activity="1.55">
            <div>
              <div class="title">Moderat aktiv</div>
              <div class="desc">3–5 træninger om ugen</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="choice" data-activity="1.725">
            <div>
              <div class="title">Meget aktiv</div>
              <div class="desc">6–7 træninger om ugen</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="choice" data-activity="1.9">
            <div>
              <div class="title">Ekstremt aktiv</div>
              <div class="desc">Fysisk job / 2 pas om dagen</div>
            </div>
            <div class="chev">›</div>
          </div>

          <div class="btnRow">
            <button class="ghost" data-back type="button">Tilbage</button>
            <button class="primary" id="calc" type="button">Beregn</button>
          </div>
        </div>
      </section>

      <!-- STEP 4: Resultat + gate -->
      <section class="step" data-step="4">
        <div class="resultsBar">
          <div class="resultBox">
            <div class="k">Dit daglige kaloriemål</div>
            <div class="v"><span id="calOut">0</span> kcal</div>
          </div>
          <div class="resultBox">
            <div class="k">Justering</div>
            <div class="v"><span id="adjOut">0</span>%</div>
          </div>
        </div>

        <div class="grid">
          <div class="sliderRow">
            <div class="sliderTop">
              <div class="label" id="adjLabel">Kalorieunderskud</div>
              <div class="val"><span id="defOut">15</span>%</div>
            </div>
            <input id="def" type="range" min="0" max="30" step="1" value="15" />
          </div>

          <p class="note">
            <strong>Få min gennemgang på mail</strong><br>
            Jeg sender dig din anbefaling og de vigtigste næste skridt ud fra dit mål.
          </p>

          <div class="mc">
            <!-- 1) UDskift action URL med din Mailchimp Embedded Form action -->
            <form id="mcForm"
              action="https://REPLACE_WITH_YOUR_MAILCHIMP_FORM_ACTION_URL"
              method="post"
              target="_blank"
              novalidate>

              <input type="text" name="FNAME" placeholder="Fornavn (valgfrit)" />
              <input type="email" name="EMAIL" placeholder="Email" required />

              <!-- 2) Merge field: CALS (skal oprettes i Mailchimp som Audience field/MERGE tag) -->
              <input type="hidden" name="CALS" id="mcCals" />

              <!-- 3) MÅDE B: Contact Tag der starter din 5-dages journey -->
              <input type="hidden" name="tags" value="calorie-calculator" />

              <label class="consent">
                <input type="checkbox" required />
                <span>Jeg accepterer at modtage emails med mit resultat og opfølgning.</span>
              </label>

              <div class="btnRow">
                <button class="ghost" data-back type="button">Tilbage</button>
                <button class="primary" type="submit">Send mig min gennemgang</button>
              </div>

              <div class="tiny">
                Tip: Tjek “Promotions” eller spam første gang.
              </div>
            </form>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // ---------- STATE ----------
    const state = {
      goal: "maintain",   // maintain | gain | lose
      sex: "female",      // female | male
      age: 35,
      height: 170,
      weight: 100,
      activity: 1.375,
      adjustPct: 15,      // used as deficit or surplus depending on goal
      calories: 0
    };

    // ---------- HELPERS ----------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function showStep(n){
      $$(".step").forEach(s => s.classList.remove("active"));
      $(`.step[data-step="${n}"]`).classList.add("active");
    }

    function selectChoice(groupSel, chosenEl){
      $$(groupSel).forEach(el => el.classList.remove("selected"));
      chosenEl.classList.add("selected");
    }

    // Revised Harris-Benedict (Roza & Shizgal)
    function bmrRevisedHB({sex, weight, height, age}){
      if(sex === "male"){
        return 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
      }
      return 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
    }

    function syncUI(){
      $("#ageOut").textContent = state.age;
      $("#heightOut").textContent = state.height;
      $("#weightOut").textContent = state.weight;

      // Label depends on goal
      const label = $("#adjLabel");
      const out = $("#defOut");
      out.textContent = state.adjustPct;

      if(state.goal === "gain"){
        label.textContent = "Kalorieoverskud";
      } else if(state.goal === "lose"){
        label.textContent = "Kalorieunderskud";
      } else {
        label.textContent = "Kaloriejustering";
      }
    }

    function compute(){
      const bmr = bmrRevisedHB(state);
      const tdee = bmr * state.activity;

      let target = tdee;

      // For maintain: default adjustPct becomes 0, but user can still change it if you want
      if(state.goal === "lose") target = tdee * (1 - state.adjustPct/100);
      if(state.goal === "gain") target = tdee * (1 + state.adjustPct/100);
      if(state.goal === "maintain") target = tdee * (1 - state.adjustPct/100);

      state.calories = Math.round(target);

      $("#calOut").textContent = state.calories;
      $("#adjOut").textContent = state.adjustPct;

      // Push calories into Mailchimp hidden field
      $("#mcCals").value = String(state.calories);
    }

    // ---------- STEP 1: goal ----------
    $$(".step[data-step='1'] .choice").forEach(el => {
      el.addEventListener("click", () => {
        selectChoice(".step[data-step='1'] .choice", el);
        state.goal = el.dataset.goal;

        // sensible defaults
        if(state.goal === "lose") state.adjustPct = 15;
        if(state.goal === "gain") state.adjustPct = 10;
        if(state.goal === "maintain") state.adjustPct = 0;

        $("#def").value = String(state.adjustPct);
        syncUI();
      });
    });

    $("#to2").addEventListener("click", () => showStep(2));

    // ---------- STEP 2: sex + sliders ----------
    $$(".step[data-step='2'] .choice[data-sex]").forEach(el => {
      el.addEventListener("click", () => {
        selectChoice(".step[data-step='2'] .choice[data-sex]", el);
        state.sex = el.dataset.sex;
      });
    });

    $("#age").addEventListener("input", e => { state.age = Number(e.target.value); syncUI(); });
    $("#height").addEventListener("input", e => { state.height = Number(e.target.value); syncUI(); });
    $("#weight").addEventListener("input", e => { state.weight = Number(e.target.value); syncUI(); });

    $("#to3").addEventListener("click", () => showStep(3));

    // ---------- STEP 3: activity ----------
    $$(".step[data-step='3'] .choice[data-activity]").forEach(el => {
      el.addEventListener("click", () => {
        selectChoice(".step[data-step='3'] .choice[data-activity]", el);
        state.activity = Number(el.dataset.activity);
      });
    });

    $("#calc").addEventListener("click", () => {
      compute();
      syncUI();
      showStep(4);
    });

    // ---------- STEP 4: adjust slider + submit ----------
    $("#def").addEventListener("input", e => {
      state.adjustPct = Number(e.target.value);
      syncUI();
      compute();
    });

    // Back buttons
    $$("[data-back]").forEach(btn => {
      btn.addEventListener("click", () => {
        const current = Number($(".step.active").dataset.step);
        showStep(Math.max(1, current - 1));
      });
    });

    // Ensure calories are set at submit time too
    $("#mcForm").addEventListener("submit", () => {
      compute();
    });

    // init
    syncUI();
  </script>
</body>
</html>
